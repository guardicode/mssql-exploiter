from typing import Callable, Sequence

from common.types import Event
from infection_monkey.exploit import IAgentOTPProvider
from infection_monkey.exploit.tools import HTTPBytesServer
from infection_monkey.i_puppet import TargetHost

from .mssql_client import StubMSSQLClient
from .mssql_options import MSSQLOptions

AgentBinaryServerFactory = Callable[[TargetHost], HTTPBytesServer]


class StubMSSQLExploiter:
    def __init__(
        self,
        exploit_client: StubMSSQLClient,
        start_agent_binary_server: AgentBinaryServerFactory,
        otp_provider: IAgentOTPProvider,
    ):
        self._exploit_client = exploit_client
        self._start_agent_binary_server = start_agent_binary_server
        self._otp_provider = otp_provider

    def exploit_host(
        self,
        target_host: TargetHost,
        servers: Sequence[str],
        current_depth: int,
        options: MSSQLOptions,
        interrupt: Event,
    ):
        pass
