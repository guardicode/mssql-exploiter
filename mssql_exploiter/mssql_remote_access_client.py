from pathlib import PurePath
from typing import Callable, Collection, Set

from common import OperatingSystem
from common.credentials import Credentials
from infection_monkey.exploit.tools import IRemoteAccessClient
from infection_monkey.i_puppet import TargetHost

from .mssql_client import StubMSSQLClient
from .mssql_options import MSSQLOptions


class StubMSSQLRemoteAccessClient(IRemoteAccessClient):
    def __init__(
        self,
        host: TargetHost,
        options: MSSQLOptions,
        command_builder: Callable[[OperatingSystem, PurePath], str],
        mssql_client: StubMSSQLClient,
    ):
        self._host = host
        self._options = options
        self._command_builder = command_builder
        self._mssql_client = mssql_client

    def login(self, credentials: Credentials, tags: Set[str]):
        pass

    def get_os(self) -> OperatingSystem:
        return OperatingSystem.WINDOWS

    def copy_file(self, file: bytes, dest: PurePath, tags: Set[str]):
        pass

    def get_writable_paths(self) -> Collection[PurePath]:
        return []

    def execute_agent(self, agent_binary_path: PurePath, tags: Set[str]):
        pass
